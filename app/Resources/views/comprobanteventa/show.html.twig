{% extends 'base.html.twig' %}

{% block header %}
    Comprobante Venta
{% endblock %}

{% block header_description %}
{% endblock %}

{% block body %}
<script>
    $(function(){
        var hash = window.location.hash;
        hash && $('ul.nav a[href="' + hash + '"]').tab('show');

        $('.nav-tabs a').click(function (e) {
          $(this).tab('show');
          var scrollmem = $('body').scrollTop() || $('html').scrollTop();
          window.location.hash = this.hash;
          $('html,body').scrollTop(scrollmem);
        });
      });
</script>
<ul class="nav nav-tabs">
    <li class="nav active">
        <a href="#tabs-1" data-toggle="tab">Venta</a>
    </li>
    <li class="nav">
        <a href="#tabs-2" data-toggle="tab">Detalles Venta</a>
    </li>
    <li class="nav">
        <a href="#tabs-3" data-toggle="tab">Recibos</a>
    </li>
</ul>
<div class="row">
    <div class="tab-content">
        <div class="tab-pane fade in active" id="tabs-1">    
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="row">
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <div class="box box-success">
                            <div class="box-header with-border">
                                <h3 class="box-title"><i class="fa fa-user"></i> Comprobante</h3>
                            </div>
                            <div class="box-body">
                                <table class="table table-hover">
                                    <tbody>
                                        <tr>
                                            <th>Pto. Venta</th>
                                            <td>{{ comprobante.puntoVenta }}</td>
                                        </tr>
                                        <tr>
                                            <th style="width:30%">Nº Int.</th>
                                            <td>{{ comprobante.numero }}</td>
                                        </tr>
                                        <tr>
                                            <th style="width:30%">Nº Fac.</th>
                                            {% if comprobante.afipNumero is empty %}
                                              <td></td>
                                            {% else %}
                                              <td>{{ comprobante.afipNumero }}</td>
                                            {% endif %}
                                        </tr>
                                        <tr>
                                            <th>Nº OT.</th>
                                            {% if comprobante.ordenTrabajo is empty %}
                                                <td></td>
                                            {% else %}
                                                <td><a href="{{ path('ordentrabajo_show', { 'id': comprobante.ordenTrabajo.Id }) }}">{{comprobante.ordenTrabajo.Id}}</a></td>
                                            {% endif %}
                                        </tr>
                                        <tr>
                                            <th>Tipo</th>
                                            <td>{{ comprobante.tipo }}</td>
                                        </tr>
                                        <tr>
                                            <th>Cliente</th>
                                            <td><a href="{{ path('cliente_show', { 'id': comprobante.cliente.Id }) }}">{{ comprobante.cliente.nombre }}</a></td>
                                        </tr>
                                        <tr>
                                            <th>Médico</th>
                                            {% if comprobante.medico is empty %}
                                                <td>-</td>
                                            {% else %}
                                                <td><a href="{{ path('medico_show', { 'id': comprobante.medico.Id }) }}">{{ comprobante.medico.nombre }}</a></td>
                                            {% endif %}
                                        </tr>
                                        <tr>
                                            <th>Obra Social</th>
                                            <td>{{ comprobante.obraSocialPlan.obraSocial.nombre }}</td>
                                        </tr>
                                        <tr>
                                            <th>Obra Social - Plan</th>
                                            <td>{{ comprobante.obraSocialPlan }}</td>
                                        </tr>
                                        <tr>
                                            <th>Fecha</th>
                                            <td>{% if comprobante.fecha %}{{ comprobante.fecha|date('d-m-Y') }}{% endif %}</td>
                                        </tr>
                                        <tr>
                                            <th>Observaciones</th>
                                            <td>{{ comprobante.observaciones }}</td>
                                        </tr>
                                        <tr>
                                            <th>Vendedor</th>
                                            <td>{{ comprobante.usuario }}</td>
                                        </tr>
                                        <tr>
                                            <th>Sucursal</th>
                                            <td>{{ comprobante.sucursal }}</td>
                                        </tr>
                                        <tr>
                                            <th>Comprobante Asociado:</th>
                                            {% if comprobante.comprobanteAsociado is empty %}
                                                <td>-</td>
                                            {% else %}
                                                <td><a href="{{ path('comprobanteventa_show', { 'id': comprobante.comprobanteAsociado.Id }) }}">{{comprobante.comprobanteAsociado.tipo.descripcion}}: {{comprobante.comprobanteAsociado.puntoVenta}}-{{comprobante.comprobanteAsociado.afipNumero}} (N° Int: {{comprobante.comprobanteAsociado.numero}})</a></td>
                                            {% endif %}
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                        <div class="box box-success">
                            <div class="box-header with-border">
                                <h3 class="box-title"><i class="fa fa-user"></i> Totales </h3>
                            </div>
                            <div class="box-body">
                                <table class="table table-hover">
                                    <tbody>
                                        <tr>
                                            <th style="width:30%">Total Neto</th>
                                            <td>{{ comprobante.totalNeto }}</td>
                                        </tr>
                                        <tr>
                                            <th>Total Bonificación</th>
                                            <td>{{ comprobante.totalBonificacion }}</td>
                                        </tr>
                                        <tr>
                                            <th>Total IVA</th>
                                            <td>{{ comprobante.importeIva }}</td>
                                        </tr>
                                        <tr>
                                            <th>Total</th>
                                            <td>{{ comprobante.total }}</td>
                                        </tr>
                                        <tr>
                                            <th>Total Pagado</th>
                                            <td>{{ (comprobante.total - comprobante.pendiente) | number_format(2, '.', '')}}</td>
                                        </tr>
                                        <tr>
                                            <th>Pendiente</th>
                                            <td>{{ comprobante.pendiente }}</td>
                                        </tr>
                                        {#
                                        <tr>
                                            <th>Total No Gravado</th>
                                            <td>{{ comprobante.totalNoGravado }}</td>
                                        </tr>
                                        <tr>
                                            <th>Importe IVA Exento</th>
                                            <td>{{ comprobante.importeIvaExento }}</td>
                                        </tr>
                                        <tr>
                                            <th>Importe Tributos</th>
                                            <td>{{ comprobante.importeTributos }}</td>
                                        </tr>
                                        <tr>
                                            <th>Total Costo</th>
                                            <td>{{ comprobante.totalCosto }}</td>
                                        </tr>
                                        <tr>
                                            <th>Total Ganancia</th>
                                            <td>{{ comprobante.totalGanancia }}</td>
                                        </tr>
                                        #}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">    
                    <div class="box box-success">
                        <div class="box-footer">
                            <div class="row">
                                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                                    <a href="{{ path('comprobanteventa_index') }}" class="btn btn-app">
                                        <i class="fa fa-arrow-left"></i> Ventas
                                    </a>
                                </div>
                                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                                    <a href="{{ path('comprobanteventa_edit', { 'id': comprobante.Id }) }}" class="btn btn-app pull-right"><span class="glyphicon glyphicon-edit"></span> Editar
                                    </a>
                                    <a href="{{ path('recibo_new', { 'comprobante': comprobante.Id }) }}" class="btn btn-app pull-right"><span class="glyphicon glyphicon-usd"></span> Nuevo Recibo
                                     </a>
                                     {% if comprobante.cliente.email is not empty %}
                                        <a href="{{ path('comprobanteventa_enviar_factura', { 'id': comprobante.Id }) }}" class="btn btn-app pull-right" title="Enviar Comprobante"><span class="glyphicon glyphicon-envelope"></span>Enviar
                                        </a>
                                    {% endif %}
                                    {%if not comprobante.caeNumero is empty%}
                                        <a href="{{ path('comprobanteventa_factura_imprimir', { 'id': comprobante.Id }) }}" class="btn btn-app pull-right" target="_blank" title="Impresión Factura Electrónica"><span class="glyphicon glyphicon-print"></span>Imprimir FE</a>
                                    {%else%}
                                        <a href="{{ path('comprobanteventa_factura_imprimir', { 'id': comprobante.Id }) }}" class="btn btn-app pull-right" target="_blank" title="Impresión Comprobante Interno"><span class="glyphicon glyphicon-print"></span>Imprimir CI</a>
                                        <a href="{{ path('comprobanteventa_facturar', { 'id': comprobante.Id }) }}" class="btn btn-app pull-right"><span class="glyphicon glyphicon-hdd"></span> Facturar</a>
                                    {%endif%}
                                </div>
                            </div>
                        </div>
                    </div>            
                </div> 
            </div> 
        </div> 
        <div class="tab-pane" id="tabs-2">  
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="row">  
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                        <div class="box box-success">
                            <div class="box-header with-border">
                                <h3 class="box-title"><i class="fa fa-user"></i> Articulos </h3>
                                <table class="table table-condensed table-hover input-sm">
                                    <thead>
                                        <tr>
                                            <th>Artículo</th>
                                            <th>Cantidad</th>
                                            <th>P. Unitario</th>
                                            <th>Bonificación %</th>
                                            <th>IVA %</th>
                                            <th>P. Venta</th>
                                            <th>Total</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    {% for comprobanteDetalle in comprobanteDetalles %}
                                        <tr>
                                            <td>{{ comprobanteDetalle.articulo.descripcion }}</td>
                                            <td>{{ comprobanteDetalle.cantidad }}</td>
                                            <td>{{ comprobanteDetalle.precioUnitario }}</td>
                                            <td>{{ comprobanteDetalle.porcentajeBonificacion }}</td>
                                            <td>{{ comprobanteDetalle.porcentajeIva }}</td>
                                            <td>{{ comprobanteDetalle.precioVenta }}</td>
                                            <td>{{ comprobanteDetalle.total }}</td>
                                        </tr>
                                    </tbody>
                                    {% endfor %}
                                </table>        
                            </div>
                        </div>
                    </div> 
                </div>
                <div class="row">    
                    <div class="box box-success">
                        <div class="box-footer">
                            <div class="row">
                                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                                    <a href="{{ path('comprobanteventa_index') }}" class="btn btn-app">
                                        <i class="fa fa-arrow-left"></i> Ventas
                                    </a>
                                </div>
                                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                                    <a href="{{ path('comprobanteventa_edit', { 'id': comprobante.Id }) }}" class="btn btn-app pull-right"><span class="glyphicon glyphicon-edit"></span> Editar
                                    </a>
                                    <a href="{{ path('recibo_new', { 'comprobante': comprobante.Id }) }}" class="btn btn-app pull-right"><span class="glyphicon glyphicon-usd"></span> Nuevo Recibo
                                     </a>
                                     {% if comprobante.cliente.email is not empty %}
                                        <a href="{{ path('comprobanteventa_enviar_factura', { 'id': comprobante.Id }) }}" class="btn btn-app pull-right" title="Enviar Comprobante"><span class="glyphicon glyphicon-envelope"></span>Enviar
                                        </a>
                                    {% endif %}
                                    {%if not comprobante.caeNumero is empty%}
                                        <a href="{{ path('comprobanteventa_factura_imprimir', { 'id': comprobante.Id }) }}" class="btn btn-app pull-right" target="_blank" title="Impresión Factura Electrónica"><span class="glyphicon glyphicon-print"></span>Imprimir FE</a>
                                    {%else%}
                                        <a href="{{ path('comprobanteventa_factura_imprimir', { 'id': comprobante.Id }) }}" class="btn btn-app pull-right" target="_blank" title="Impresión Comprobante Interno"><span class="glyphicon glyphicon-print"></span>Imprimir CI</a>
                                        <a href="{{ path('comprobanteventa_facturar', { 'id': comprobante.Id }) }}" class="btn btn-app pull-right"><span class="glyphicon glyphicon-hdd"></span> Facturar</a>
                                    {%endif%}
                                </div>
                            </div>
                        </div>
                    </div>            
                </div>
            </div>
        </div>
        <div class="tab-pane" id="tabs-3">  
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="row">  
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                        <div class="box box-success">
                            <div class="box-header with-border">
                                <h3 class="box-title"><i class="fa fa-user"></i> Recibos</h3>
                                <table class="table table-condensed table-hover input-sm">
                                    <tr>
                                        <th style="width: 10%">Nº Recibo</th>
                                        <th>Cliente</th>
                                        <th>Fecha</th>
                                        <th>Total</th>
                                        <th>Disponible</th>
                                        <th>Observaciones</th>
                                        <th>Importe Comprobante</th>
                                        <th style="width: 5%">Acciones</th>
                                    </tr>
                                    <tbody>
                                    {% for reciboComprobante in reciboComprobantes %}
                                        {% set recibo = reciboComprobante.recibo %}
                                        <tr>
                                            <td>{{ recibo.numero }}</td>
                                            <td>{{ recibo.cliente }}</td>
                                            <td>{{ recibo.fecha|date('d-m-Y') }}</td>
                                            <td>{{ recibo.total }}</td>
                                            <td>{{ recibo.disponible }}</td>
                                            <td>{{ recibo.observaciones }}</td> 
                                            <td>{{ reciboComprobante.importe }}
                                            <td>
                                              <a href="{{ path('recibo_show', { 'id': recibo.Id }) }}"><span class="glyphicon glyphicon-eye-open"></span>
                                              </a>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                              </table>
                            </div>
                        </div>
                    </div> 
                </div>
                <div class="row">    
                    <div class="box box-success">
                        <div class="box-footer">
                            <div class="row">
                                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                                    <a href="{{ path('comprobanteventa_index') }}" class="btn btn-app">
                                        <i class="fa fa-arrow-left"></i> Ventas
                                    </a>
                                </div>
                                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                                    <a href="{{ path('comprobanteventa_edit', { 'id': comprobante.Id }) }}" class="btn btn-app pull-right"><span class="glyphicon glyphicon-edit"></span> Editar
                                    </a>
                                    <a href="{{ path('recibo_new', { 'comprobante': comprobante.Id }) }}" class="btn btn-app pull-right"><span class="glyphicon glyphicon-usd"></span> Nuevo Recibo
                                     </a>
                                     {% if comprobante.cliente.email is not empty %}
                                        <a href="{{ path('comprobanteventa_enviar_factura', { 'id': comprobante.Id }) }}" class="btn btn-app pull-right" title="Enviar Comprobante"><span class="glyphicon glyphicon-envelope"></span>Enviar
                                        </a>
                                    {% endif %}
                                    {%if not comprobante.caeNumero is empty%}
                                        <a href="{{ path('comprobanteventa_factura_imprimir', { 'id': comprobante.Id }) }}" class="btn btn-app pull-right" target="_blank" title="Impresión Factura Electrónica"><span class="glyphicon glyphicon-print"></span>Imprimir FE</a>
                                    {%else%}
                                        <a href="{{ path('comprobanteventa_factura_imprimir', { 'id': comprobante.Id }) }}" class="btn btn-app pull-right" target="_blank" title="Impresión Comprobante Interno"><span class="glyphicon glyphicon-print"></span>Imprimir CI</a>
                                        <a href="{{ path('comprobanteventa_facturar', { 'id': comprobante.Id }) }}" class="btn btn-app pull-right"><span class="glyphicon glyphicon-hdd"></span> Facturar</a>
                                    {%endif%}
                                </div>
                            </div>
                        </div>
                    </div>            
                </div>
            </div>
        </div> 
    </div>
</div> 
{% endblock %}


